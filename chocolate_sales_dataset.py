# -*- coding: utf-8 -*-
"""Chocolate Sales Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1J8Da8l4i7Xmg2aMiDSzfh_ZfUvLVLw0_
"""

# Import libraries
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from google.colab import files

#Upload the dataset in Colab
uploaded = files.upload()

#download the csv file from the link : https://www.kaggle.com/datasets/atharvasoundankar/chocolate-sales/data

# Load the dataset (replace 'Chocolate Sales.csv' with your filename)
data = pd.read_csv(next(iter(uploaded.keys())))  # Auto-detects uploaded file
print("Data loaded successfully!")
print(data.head())

# Data Cleaning
data['Amount'] = data['Amount'].str.replace('$', '').str.replace(',', '').astype(float)
data['Date'] = pd.to_datetime(data['Date'], dayfirst=True)  # Handles '04-Jan-22' format
print("\nData after cleaning:")
print(data.info())

# EDA: Basic Statistics
print("\nBasic Statistics:")
print(data.describe())

# Visualizations
plt.figure(figsize=(15, 10))

#  Distribution of Amount
plt.subplot(2, 2, 1)
sns.histplot(data["Amount"], bins=20, kde=True)
plt.title("Amount Distribution")

# Top 5 Products by Revenue
plt.subplot(2, 2, 2)
top_products = data.groupby('Product')['Amount'].sum().nlargest(5)
sns.barplot(x=top_products.index, y=top_products.values)
plt.xticks(rotation=45)
plt.title("Top 5 Products by Revenue")

# Top 10 products by shipped boxes
sales_product_trend = data.groupby('Product')['Boxes Shipped'].sum().sort_values(ascending=False).head(5)
print(f'Top 10 shipped products:\n{sales_product_trend}')
sns.barplot(x=sales_product_trend.index, y=sales_product_trend.values)
plt.xlabel('Product')
plt.ylabel('Shipped Boxes')
plt.title('Top 10 Products by Shipped Boxes')
plt.xticks(rotation=45)
plt.show()

#less 5 products by revenue
sales_product_revenue = data.groupby('Product')['Amount'].sum().sort_values(ascending=True).head(5)
print(f'less 5 products by revenue:\n{sales_product_revenue}')
sns.barplot(x=sales_product_revenue.index, y=sales_product_revenue.values)
plt.xlabel('Product')
plt.ylabel('Revenue')
plt.title('less 5 Products by Revenue')
plt.xticks(rotation=45)

# Sales Revenue Over Time
plt.subplot(2, 2, 3)
data.groupby('Date')['Amount'].sum().plot()
plt.xticks(rotation=45)
plt.title("Sales Revenue Over Time")

# Top Countries by Revenue (Pie Chart)
plt.subplot(2, 2, 4)
top_countries = data.groupby('Country')['Amount'].sum().nlargest(5)
plt.pie(top_countries, labels=top_countries.index, autopct='%1.1f%%')
plt.title("Top 5 Countries by Revenue")

plt.tight_layout()
plt.show()

# Top 5 countries shipped boxes
country_shipped_boxes = data.groupby('Country')['Boxes Shipped'].sum().sort_values(ascending=False).head(5)
print(f'Top 5 countries by shipped boxes:\n{country_shipped_boxes}')
plt.pie(country_shipped_boxes, labels=country_shipped_boxes.index, autopct='%1.1f%%')
plt.title('Top 5 Countries by Shipped Boxes')
plt.show()

# Correlation Heatmap (only numeric columns)
numeric_data = data.select_dtypes(include=['number'])
sns.heatmap(numeric_data.corr(), annot=True, cmap='coolwarm')
plt.title("Correlation Heatmap")
plt.show()